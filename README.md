Upstreamed from BitBucked, commits on the master branch.
